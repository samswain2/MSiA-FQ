df_selected = df[sig_features]
# cor(df_selected)
# vif(step.model)
keep = c('PARK_AREA_ACRES', 'CAPACITY', 'MINORITY', 'ARSON', 'CRIMINAL_DAMAGE', 'PROSTITUTION', 'STALKING', 'trips')
df_keep = df_selected[keep]
keep.model = lm(trips ~ ., data = df_keep)
summary(keep.model)
vif(keep.model)
cor(df_selected)
keep = c('PARK_AREA_ACRES', 'CAPACITY', 'MINORITY', 'ARSON', 'CRIMINAL_DAMAGE', 'PROSTITUTION', 'STALKING', 'trips')
df_keep = df_selected[keep]
keep.model = lm(trips ~ ., data = df_keep)
summary(keep.model)
vif(keep.model)
cor(df_keep)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
# cor(df_selected)
vif(step.model)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
vif(step.model)
cor(df_selected)
round(cor(df_selected), 2)
round(cor(df_selected), 5)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
vif(step.model)
round(cor(df_selected), 2)
keep = c('PARK_AREA_ACRES', 'CAPACITY', 'MINORITY', 'ARSON', 'CRIMINAL_DAMAGE', 'PROSTITUTION', 'STALKING', 'trips')
df_keep = df_selected[keep]
keep.model = lm(trips ~ (.)^2, data = df_keep)
summary(keep.model)
vif(keep.model)
cor(df_keep)
keep = c('PARK_AREA_ACRES', 'CAPACITY', 'MINORITY', 'ARSON', 'CRIMINAL_DAMAGE', 'PROSTITUTION', 'STALKING', 'trips')
df_keep = df_selected[keep]
keep.model = lm(trips ~ ., data = df_keep)
summary(keep.model)
vif(keep.model)
cor(df_keep)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
vif(step.model)
#round(cor(df_selected), 2)
round(cor(full.model), 2)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
vif(step.model)
#round(cor(df_selected), 2)
round(cor(df), 2)
#round(cor(df_selected), 2)
round(cor(df), 2)
df = read.csv("bike.csv")
df = subset(df, select = -c('ID'))
df = read.csv("bike.csv")
df = subset(df, select = -'ID')
df = read.csv("bike.csv")
df = subset(df, select = -47)
df = read.csv("bike.csv")
df = subset(df, select = -47)
df = read.csv("bike.csv")
df = subset(df, select = -46)
View(df)
View(df)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
vif(step.model)
#round(cor(df_selected), 2)
round(cor(df), 2)
df = read.csv("bike.csv")
df = subset(df, select = -46)
View(df)
df = read.csv("bike.csv")
df = subset(df, select = -1)
library(MASS)
library(car)
full.model <- lm(trips ~ ., data = df)
step.model <- stepAIC(full.model,
direction = "both",
trace = FALSE)
summary(step.model)
#vif(step.model)
sig_features = c('PARK_AREA_ACRES', 'CTA_TRAIN_STATIONS',
'Retail_Food_Establishment', 'CAPACITY',
'POPULATION_SQ_MILE', 'CBD', 'MINORITY',
'EDU', 'ARSON', 'ASSAULT', 'BATTERY',
'CRIMINAL_DAMAGE', 'GAMBLING', 'NON_CRIMINAL',
'OBSCENITY', 'OTHER_OFFENSE', 'PROSTITUTION',
'STALKING', 'THEFT', 'trips')
df_selected = df[sig_features]
vif(step.model)
#round(cor(df_selected), 2)
round(cor(df), 2)
colnames(df)
all_names = colnames(df)
all_names
View(df)
df = read.csv("bike.csv")
df = subset(df, select = -c(1, 46))
View(df)
all_names = colnames(df)
all_names
all_names = colnames(df)
df_clean = df[all_names]
#full_model = lm(, data = df)
View(df_clean)
#full_model = lm(, data = df)
all_names
full_model = lm(trips ~ . + PARK_AREA_ACRES*CTA_BUS_STATIONS, data = df)
full_model
summary(full_model)
full_model = lm(trips ~ (.)^2, data = df)
all_names
summary(full_model)
full_model = lm(trips ~ ., data = df)
all_names
summary(full_model)
full_model = lm(trips ~ . + , data = df)
#full_model = lm(trips ~ . + , data = df)
all_names
summary(full_model)
round(cor(df), 2)
View(df_clean)
#full_model = lm(trips ~ . + , data = df)
all_names
summary(full_model)
round(cor(df), 2)
full_model = lm(trips ~ . + ASSAULT * CTA_BUS_STATIONS * BATTERY * CRIM_SEXUAL_ASSUALT * CRIMINAL_DAMAGE * CRIMINAL_TRESPASS * DECEPTIVE_PRACTICE, data = df)
summary(full_model)
full_model = lm(trips ~ . + ASSAULT * CTA_BUS_STATIONS * BATTERY * CRIM_SEXUAL_ASSAULT * CRIMINAL_DAMAGE * CRIMINAL_TRESPASS * DECEPTIVE_PRACTICE, data = df)
full_model = lm(trips ~ . + ASSAULT * CTA_BUS_STATIONS * BATTERY * CRIM_SEXUAL_ASSAULT * CRIMINAL_DAMAGE * CRIMINAL_TRESPASS * DECEPTIVE_PRACTICE, data = df)
all_names
summary(full_model)
#round(cor(df), 2)
full_model = lm(trips ~ (.)^2, data = df)
all_names
summary(full_model)
#round(cor(df), 2)
full_model = lm(trips ~ BIKE_ROUTES, data = df)
summary(full_model)
all_names
full_model = lm(trips ~ PARK_AREA_ACRES + BIKE_ROUTES, data = df)
all_names
summary(full_model)
all_names
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_BUS_STATIONS, data = df)
all_names
summary(full_model)
#round(cor(df), 2)
all_names
full_model = lm(trips ~ (.)^2, data = df)
#full_model = lm(trips ~ PARK_AREA_ACRES + CTA_BUS_STATIONS, data = df)
summary(full_model)
#round(cor(df), 2)
vif(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_BUS_STATIONS, data = df)
summary(full_model)
#round(cor(df), 2)
vif(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_BUS_STATIONS + CTA_TRAIN_STATIONS, data = df)
summary(full_model)
#round(cor(df), 2)
vif(full_model)
round(cor(df), 2)
all_names
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_BUS_STATIONS*CTA_TRAIN_STATIONS, data = df)
summary(full_model)
vif(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS, data = df)
vif(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS, data = df)
summary(full_model)
vif(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS + Limited_Business_License, data = df)
summary(full_model)
vif(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License, data = df)
summary(full_model)
vif(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + BIKE_ROUTES , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + Retail_Food_Establishment, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + Retail_Food_Establishment*Limited_Business_License, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + Retail_Food_Establishment*Limited_Business_License, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + CAPACITY, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + CAPACITY + PER_CAPITA_INCOME , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + CAPACITY + POPULATION_SQ_MILE, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + CAPACITY + POPULATION_SQ_MILE + CBD, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + CAPACITY + POPULATION_SQ_MILE , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CTA_TRAIN_STATIONS*Limited_Business_License + CAPACITY + POPULATION_SQ_MILE + MINORITY   , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + POPULATION_SQ_MILE + MINORITY   , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY   , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY +EDU , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + EDU + ARSON , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + EDU + ARSON + ASSAULT , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + EDU + ARSON + ASSAULT*BATTERY, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + BURGLARY , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + BURGLARY*ASSAULT*BATTERY , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + BURGLARY*BATTERY , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO +CRIM_SEXUAL_ASSAULT , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + GAMBLING , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + GAMBLING*THEFT , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE  , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + HUMAN_TRAFFICKING , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + HUMAN_TRAFFICKING*KIDNAPPING , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + HUMAN_TRAFFICKING*PROSTITUTION , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + OBSCENITY, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + OFFENSE_INVOLVING_CHILDREN , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + OFFENSE_INVOLVING_CHILDREN*KIDNAPPING , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + OTHER_NARCOTIC_VIOLATION , data = df)
summary(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + OTHER_NARCOTIC_VIOLATION, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + PROSTITUTION , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + PROSTITUTION*PUBLIC_INDECENCY  , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + PROSTITUTION + STALKING  , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING  , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING + ROBBERY*THEFT , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON +  CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING + ROBBERY*THEFT , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING  , data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING  + ROBBERY*THEFT +, data = df)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING  + ROBBERY*THEFT, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON  + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING  + ROBBERY*THEFT, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING + WEAPONS_VIOLATION, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS  + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS*Limited_Business_License   + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(log(trips) ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
keep = c('PARK_AREA_ACRES', 'CAPACITY', 'MINORITY', 'ARSON', 'CRIMINAL_DAMAGE', 'PROSTITUTION', 'STALKING', 'trips')
df_keep = df_selected[keep]
keep.model = lm(trips ~ ., data = df_keep)
summary(keep.model)
vif(keep.model)
cor(df_keep)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY + ARSON, data = df)
summary(full_model)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY, data = df)
summary(full_model)
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
#full_model = lm(trips ~ (.)^2, data = df)
full_model = lm(trips ~ PARK_AREA_ACRES + CAPACITY + CTA_TRAIN_STATIONS + MINORITY + ARSON + ASSAULT*BATTERY + CONCEALED_CARRY_LICENSE_VIOLATIO + HOMICIDE + STALKING, data = df)
summary(full_model)
vif(full_model,type = 'predictor')
step.model <- stepAIC(full_model,
direction = "both",
trace = FALSE)
summary(step.model)
